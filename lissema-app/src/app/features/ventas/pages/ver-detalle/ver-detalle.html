<div class="modal-backdrop-custom">

  <div class="modal-custom">

    <!-- HEADER -->
    <div class="modal-header">
      <h5>Detalle de Venta #{{ venta?.id }}</h5>
      <button class="btn-close" (click)="cerrar.emit()"></button>
    </div>

    <!-- BODY SCROLLEABLE -->
    <div class="modal-body" *ngIf="venta">

      <div class="info">
        <p><b>Fecha:</b> {{ venta.fecha | date:'dd/MM/yyyy HH:mm' }}</p>
        <p><b>Cliente:</b> {{ venta.cliente?.nombreDueno || 'Consumidor Final' }}</p>
        <p><b>Usuario:</b> {{ venta.usuario.nombre }}</p>
      </div>

      <hr>

      <!-- CONTENEDOR DE TABLA -->
      <div class="tabla-wrapper">
        <table class="table table-sm table-bordered">
          <thead class="table-light sticky-top">
            <tr>
              <th>Producto</th>
              <th>Cant.</th>
              <th>Precio</th>
              <th>Subtotal</th>
            </tr>
          </thead>

          <tbody>
            <tr *ngFor="let d of venta.detalles">
              <td>{{ d.producto.nombre }}</td>
              <td>{{ d.cantidad }}</td>
              <td>${{ d.precioUnitario }}</td>
              <td>${{ d.cantidad * d.precioUnitario }}</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- NOTA DE CRÉDITO -->
      <div *ngIf="venta.notaCredito" class="nota-box">
        <h6 class="text-success">Nota de Crédito aplicada</h6>

        <p><b>ID:</b> #{{ venta.notaCredito.id }}</p>
        <p><b>Monto usado:</b> ${{ venta.montoNotaUsado }}</p>
        <p>
          <b>Estado:</b>
          <span class="badge bg-success" *ngIf="venta.notaCredito.estado === 'USADA'">USADA</span>
          <span class="badge bg-warning text-dark" *ngIf="venta.notaCredito.estado === 'PARCIAL'">PARCIAL</span>
          <span class="badge bg-secondary" *ngIf="venta.notaCredito.estado === 'DISPONIBLE'">DISPONIBLE</span>
        </p>
      </div>

      <h5 class="text-end mt-3">
        Total: ${{ venta.total }}
      </h5>

    </div>

    <!-- FOOTER FIJO -->
    <div class="modal-footer">
      <button class="btn btn-secondary" (click)="cerrar.emit()">
        Cerrar
      </button>
    </div>

  </div>
</div>
