import{a as k}from"./chunk-PJHS6D3N.js";import{a as T}from"./chunk-ODID5PJH.js";import"./chunk-FK6H3RFT.js";import{a as O}from"./chunk-HSY23XSR.js";import{$a as y,A as u,B as _,Ja as I,La as N,Na as $,O as r,T as b,U as h,Xa as F,Y as x,ab as D,bb as w,eb as L,fa as s,ga as i,gb as P,ha as e,ia as f,ja as v,ka as S,ma as E,na as C,oa as m,xa as a,ya as g,za as d}from"./chunk-4YEZQ5FG.js";import"./chunk-KAT7YFEL.js";var A=(l,o,t)=>({"bg-success":l,"bg-warning text-dark":o,"bg-secondary":t});function U(l,o){if(l&1&&(i(0,"span"),a(1),e()),l&2){let t=m(2).$implicit;r(),d(" (",t.cliente==null?null:t.cliente.cuit,") ")}}function V(l,o){if(l&1&&(i(0,"tr")(1,"td"),a(2),e(),i(3,"td"),a(4),e(),i(5,"td"),a(6),e(),i(7,"td"),a(8),e()()),l&2){let t=o.$implicit;r(2),g(t.ventaDetalle.producto.nombre),r(2),g(t.cantidad),r(2),d("$",t.precioUnitario),r(2),d("$",t.cantidad*t.precioUnitario)}}function j(l,o){if(l&1&&(i(0,"tr")(1,"td",16)(2,"div",17)(3,"strong"),a(4,"Cliente:"),e(),a(5),x(6,U,2,1,"span",15),e(),i(7,"table",18)(8,"thead")(9,"tr")(10,"th"),a(11,"Producto"),e(),i(12,"th"),a(13,"Cantidad"),e(),i(14,"th"),a(15,"Precio"),e(),i(16,"th"),a(17,"Subtotal"),e()()(),i(18,"tbody"),x(19,V,9,4,"tr",9),e()()()()),l&2){let t=m().$implicit;r(5),d(" ",(t.cliente==null?null:t.cliente.nombreDueno)||"Consumidor Final"," "),r(),s("ngIf",t.cliente==null?null:t.cliente.cuit),r(13),s("ngForOf",t.detalles)}}function R(l,o){if(l&1){let t=E();v(0),i(1,"tr")(2,"td"),a(3),e(),i(4,"td"),a(5),N(6,"date"),e(),i(7,"td"),a(8),e(),i(9,"td")(10,"div",10),a(11),e(),i(12,"small",11),a(13),e()(),i(14,"td")(15,"span",12),a(16),e()(),i(17,"td",8)(18,"button",13),C("click",function(){let p=u(t).$implicit,c=m();return _(c.toggle(p.id))}),a(19," Detalle "),e(),i(20,"button",14),C("click",function(){let p=u(t).$implicit,c=m();return _(c.descargar(p))}),a(21," PDF "),e()()(),x(22,j,20,3,"tr",15),S()}if(l&2){let t=o.$implicit,n=m();r(3),g(t.id),r(2),g($(6,8,t.fecha,"dd/MM/yyyy")),r(3),d(" ",(t.cliente==null?null:t.cliente.nombreDueno)||"Consumidor Final"," "),r(3),d(" $",t.total," "),r(2),d(" Saldo: $",t.total-t.montoUsado," "),r(2),s("ngClass",I(11,A,t.estado==="DISPONIBLE",t.estado==="PARCIAL",t.estado==="USADA")),r(),d(" ",t.estado," "),r(6),s("ngIf",n.abierta===t.id)}}var M=class l{constructor(o,t){this.service=o;this.cdr=t}notas=[];abierta=null;ngOnInit(){this.service.notas$.subscribe(o=>{this.notas=[...o],this.cdr.markForCheck(),console.log(this.notas)}),this.service.cargarNotas()}toggle(o){this.abierta=this.abierta===o?null:o}descargar(o){let t=new T,n=20;t.setFontSize(16),t.text("Nota de Cr\xE9dito",105,n,{align:"center"}),n+=10,t.setFontSize(11),t.text(`N\xB0: ${o.id}`,10,n),n+=6,t.text(`Fecha: ${new Date(o.fecha).toLocaleDateString()}`,10,n),n+=6;let p=o.cliente?.nombreDueno||"Consumidor Final";t.text(`Cliente: ${p}`,10,n),n+=10,t.setFont("helvetica","bold"),t.text("Producto",10,n),t.text("Cant.",90,n),t.text("Precio",120,n),t.text("Subtotal",160,n),n+=5,t.setFont("helvetica","normal"),o.detalles.forEach(c=>{n>270&&(t.addPage(),n=20),t.text(c.ventaDetalle.producto.nombre,10,n),t.text(String(c.cantidad),95,n,{align:"right"}),t.text(`$${c.precioUnitario}`,125,n,{align:"right"}),t.text(`$${c.cantidad*c.precioUnitario}`,170,n,{align:"right"}),n+=6}),n+=8,t.setFont("helvetica","bold"),t.text(`TOTAL: $${o.total}`,170,n,{align:"right"}),t.save(`nota-credito-${o.id}.pdf`)}static \u0275fac=function(t){return new(t||l)(b(k),b(F))};static \u0275cmp=h({type:l,selectors:[["app-listar-notas-credito"]],decls:25,vars:1,consts:[[1,"container","mt-4","mb-4"],[1,"text-center","mb-3"],["src","assets/img/lisemma-logo.png",1,"logo"],[1,"text-center","titulo","mb-4"],[1,"card","shadow"],[1,"card-body"],[1,"table","table-striped","table-hover","align-middle"],[1,"table-light"],[1,"text-end"],[4,"ngFor","ngForOf"],[1,"fw-bold","text-danger"],[1,"text-muted"],[1,"badge",3,"ngClass"],[1,"btn","btn-sm","btn-outline-secondary","me-1",3,"click"],[1,"btn","btn-sm","btn-outline-danger",3,"click"],[4,"ngIf"],["colspan","6",1,"bg-light"],[1,"mb-2"],[1,"table","table-sm","mb-0"]],template:function(t,n){t&1&&(f(0,"app-header"),i(1,"div",0)(2,"div",1),f(3,"img",2),e(),i(4,"h2",3),a(5,"Notas de Cr\xE9dito"),e(),i(6,"div",4)(7,"div",5)(8,"table",6)(9,"thead",7)(10,"tr")(11,"th"),a(12,"#"),e(),i(13,"th"),a(14,"Fecha"),e(),i(15,"th"),a(16,"Cliente"),e(),i(17,"th"),a(18,"Total"),e(),i(19,"th"),a(20,"Estado"),e(),i(21,"th",8),a(22,"Acciones"),e()()(),i(23,"tbody"),x(24,R,23,15,"ng-container",9),e()()()()()),t&2&&(r(24),s("ngForOf",n.notas))},dependencies:[P,y,D,w,O,L],styles:[".logo[_ngcontent-%COMP%]{width:120px}.titulo[_ngcontent-%COMP%]{font-weight:600}"]})};export{M as ListarNotasCredito};
